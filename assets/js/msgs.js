function updateActionElements(){var t=allAnswers();for(let e=0;e<t.length;e+=1){const n=t[e];actionUpdates(n,e),n.addEventListener("DOMSubtreeModified",()=>{actionUpdates(n,e)})}}function actionUpdates(e,t){actionContainer(e,t),addCopyButtonToResult(e,t),updateCounterForResult(e,t)}function actionContainer(e,t){document.querySelector("#action-buttons-"+t)||(t=Object.assign(document.createElement("div"),{id:"action-buttons-"+t,className:"gpt-optimizer gpto-actions"}),e.insertAdjacentElement("afterend",t))}function addCopyButtonToResult(t,e){if(!document.querySelector("#result-copy-button-"+e)){var n=document.querySelector("#action-buttons-"+e),o=Object.assign(document.createElement("div"),{className:"gpt-optimizer gpto-action-buttons"}),a=()=>t.innerText.replace("Copy code","");const r=Object.assign(document.createElement("button"),{id:"result-copy-button-"+e,className:"gpt-optimizer gpto-button",textContent:"Copy",onclick:e=>{e.shiftKey?copyRichText(t):navigator.clipboard.writeText(a()),r.textContent="Copied!",setTimeout(()=>{r.textContent="Copy"},1500),toast("Text copied")}});o.appendChild(r);var s=Object.assign(document.createElement("p"),{className:"gpt-optimizer gpto-button",innerText:"Copy HTML",onclick:()=>{navigator.clipboard.writeText(t.innerHTML),s.textContent="Copied!",setTimeout(()=>{s.textContent="Copy HTML"},1500),toast("HTML copied")}}),i=(o.appendChild(s),!1),c=Object.assign(document.createElement("p"),{className:"gpt-optimizer gpto-button gpto-read-aloud",innerText:"Read Aloud",onclick:e=>{e.altKey||e.metaKey?popup(`
                        <div>
                            <select class="voiceSelection gpto-textarea"></select>
                            <select class="languageSelection gpto-textarea"></select>
                        </div>
                        <button class="submitVoice gpto-button">Start Reading</button>
                        <p>note: persistance voice settings and language filter will be added in march</p>
                    `,`
                    #toastHTML select {
                        background: black;
                    }
                    #toastHTML p {
                        font-size: .6rem;
                    }
                    `,e=>{const n=e.querySelector(".voiceSelection"),o=e.querySelector(".languageSelection");e.querySelector(".submitVoice").onclick=()=>{d(gptoVoices.find(e=>e.voiceURI===n.value)),e.close()},n.innerHTML="",o.appendChild(Object.assign(document.createElement("option"),{textContent:"all",value:"all"})),window.speechSynthesis.onvoiceschanged=()=>{const e=window.speechSynthesis.getVoices();e.forEach((e,t)=>{n.appendChild(Object.assign(document.createElement("option"),{textContent:e.name,value:e.voiceURI})),o.appendChild(Object.assign(document.createElement("option"),{textContent:e.lang,value:e.lang}))}),o.onchange=()=>{n.innerHTML="",e.forEach((e,t)=>{"all"!==o.value&&e.lang!==o.value||n.appendChild(Object.assign(document.createElement("option"),{textContent:e.name,value:t}))})}},window.speechSynthesis.onvoiceschanged()},"Select A Voice"):getStandardVoice(e=>{d(e)})}}),l=(window.onbeforeunload=function(){window.speechSynthesis.cancel()},Object.assign(document.createElement("p"),{className:"gpt-optimizer gpto-button",innerText:"⏹️ Stop",style:"display: none"}));function d(e){var t=window.speechSynthesis,n=new SpeechSynthesisUtterance(a());0<t.getVoices().length&&(n.voice=e),t.speaking&&!i?(t.pause(),i=!0,c.textContent="⏯️ Resume"):t.speaking&&i?(t.resume(),i=!1,c.textContent="⏸️ Pause"):(n.onstart=()=>{i=!!0,toast("Generating..."),c.textContent="⏸️ Pause"},n.onpause=()=>{i=!0,c.textContent="⏯️ Resume"},n.onresume=()=>{i=!1,c.textContent="⏸️ Pause"},n.onend=()=>{i=!1,toast("Ready!"),c.textContent="Read Aloud",l.style.display="none"},l.style.display="inline-block",l.onclick=()=>{t.cancel(),c.textContent="Read Aloud",l.style.display="none"},t.speak(n))}o.appendChild(c),o.appendChild(l),n.appendChild(o)}}function updateCounterForResult(e,t){var n=document.querySelector("#action-buttons-counter-"+t),o=n?n.innerText:"",e=e.innerText,a=e.length,e=e.split(/[ /]/).length,a=Object.assign(document.createElement("div"),{textContent:`${a||0} chars | ${e||0} words`,className:"gpt-optimizer gpto-msg-details"});o!==a.textContent&&(n&&n.remove(),a.id="action-buttons-counter-"+t,document.querySelector("#action-buttons-"+t).appendChild(a))}function setMessageDelete(e=null){const t=e=>{if(!e.querySelector(".gpto-deleteMessage")){const t=e.querySelector("img").parentNode.parentNode.parentNode.parentNode;t.classList.add("gpto-messageActions");e=Object.assign(document.createElement("div"),{innerHTML:'<svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>',className:"gpto-deleteMessage"});t.append(e),e.addEventListener("click",()=>{t.parentNode.parentNode.remove()})}};"onLatest"===e?startedWritingLatestUserMessage(e=>{t(e)}):getAllUserMessages().forEach(e=>{t(e)})}function setThumbSelector(){document.querySelectorAll(".prose").forEach(e=>{e.parentNode.parentNode.parentNode.childNodes[1].childNodes[0].classList.add("gpto-thumbsToRate")})}